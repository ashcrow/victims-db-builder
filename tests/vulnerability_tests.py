import unittest
from victims_db_builder import vulnerability
import re


def test_print_flaw():
    vul = vulnerability.construct_yaml('tests/data/6504.yaml')
    vul.print_flaw()

def test_versions_up_only():
    vuln = vulnerability.construct_yaml('tests/data/3192.yaml')
    library = vuln.libraries.pop()
    assert '3.2.13' == library.versions[0].base
    assert '4.1.6' == library.versions[1].base
